<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source">


    <link rel="dns-prefetch" href="https://cdn1.lncld.net">




    <link rel="dns-prefetch" href="https://cdn1.lncld.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">





    <link rel="dns-prefetch" href="https://fonts.proxy.ustclug.org">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
    <style>
        .pace .pace-progress {
            background: #1E92FB; /*进度条颜色*/
            height: 3px;
        }
        .pace .pace-progress-inner {
             box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
        }
        .pace .pace-activity {
            border-top-color: #1E92FB;    /*上边框颜色*/
            border-left-color: #1E92FB;    /*左边框颜色*/
        }
    </style>

    <!-- Title -->
    
    <title>
        
            Ajax分页与缓存池 | 
        
        火星土豆的菜园
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content="火星土豆的菜园">
    <meta name="keywords" content="火星">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg1.jpg);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/css/material-icons.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.bootcss.com/jquery/2.2.1/jquery.min.js", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="火星土豆的菜园">
    <meta name="msapplication-starturl" content="http://yoursite.com/2018/12/22/Ajax分页与缓存池/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="火星土豆的菜园">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com/2018/12/22/Ajax分页与缓存池/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Ajax分页与缓存池 | 火星土豆的菜园">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="火星土豆的菜园">
    

    
        <meta property="article:published_time" content="Sat Dec 22 2018 14:58:36 GMT+0800">
        <meta property="article:modified_time" content="Sat Dec 22 2018 15:19:16 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yoursite.com/2018/12/22/Ajax分页与缓存池/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yoursite.com/2018/12/22/Ajax分页与缓存池/index.html",
    "headline": "Ajax分页与缓存池",
    "datePublished": "Sat Dec 22 2018 14:58:36 GMT+0800",
    "dateModified": "Sat Dec 22 2018 15:19:16 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "MartianPotato",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.webp"
        },
        "description": "ヾ(◍°∇°◍)ﾉﾞ,欢迎来到,火星土豆的菜园子~"
    },
    "publisher": {
        "@type": "Organization",
        "name": "火星土豆的菜园",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": "火星",
    "description": "火星土豆的菜园",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 16 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/w' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                Ajax分页与缓存池
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.webp" width="44px" height="44px" alt="Author Avatar">
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>MartianPotato</strong>
        <span>12月 22, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>Ajax分页与缓存池</p>
<p>关于Ajax的原理及代码实现不再赘述, 本文主要解决前端页面请求某一页数据后, 再次请求时的数据缓存优化. </p>
<p>试想这样一种情况,用户在访问不同的页面时,比如查询不同的电影页信息, 是很有可能再次返回刚才的页面, </p>
<p>如果每次访问同一重复页面, 都需要向后台发送请求, 比如说豆瓣的电影页, 用户量大了难免会浪费服务器资源, 所以作为一名合格的前端工程师,应该在每次请求数据是将数据缓存起来, 再次访问同一页面的时候, 先判断之前是否请求过该页面, 如果请求过,则直接从缓存池中取数据即可, 这样不仅访问速度加快, 后台的访问压力也会减小. </p>
<p>0.前端的主要职责需要考虑</p>
<p>交互,效率,体验</p>
<p>效率:能够减少请求</p>
<p>尽量减少请求</p>
<p>如何做到?</p>
<p>请求过的数据保存在js的独立内存里</p>
<p>自己创造一个缓存池</p>
<p>语言本身都有内存机制</p>
<p>只要页面不管不刷新,全局变量的值不会被回收</p>
<pre><code>function myAjax(opt) {

    opt = opt || {};

    opt.method = opt.method || &apos;GET&apos;;//请求方式 默认是GET

    opt.url = opt.url || &apos;&apos;; //请求地址 默认为空链接

    opt.async = opt.async || true;// 是否异步, 默认为真, 表示异步请求

    opt.data = opt.data || null;//请求参数 默认无参数

    opt.dataType = opt.dataType || &apos;JSON&apos;;//服务器返回数据类型 默认为JSON

    opt.success = opt.success || function () {};

    var xmlHttp = null;

    if (XMLHttpRequest) {

        xmlHttp = new XMLHttpRequest();

    }

    else {

        xmlHttp = new ActiveXObject(&apos;Microsoft.XMLHTTP&apos;); //兼容ie

    }

    var params = [];

    for (var key in opt.data)params.push(key + &apos;=&apos; + opt.data[key]);

        // console.log(params);//[&quot;page=1&quot;, &quot;limit=5&quot;]

        // console.log(opt.async); //true表示异步

    var postData = params.join(&apos;&amp;&apos;);

        // console.log(postData); //page=1&amp;limit=5

    if (opt.dataType === &apos;JSONP&apos;) {

        creatScript(opt.url, postData);

    } else {

        if (opt.method.toUpperCase() === &apos;POST&apos;) {

            xmlHttp.open(opt.method, opt.url, opt.async);

            xmlHttp.responseType = &apos;document&apos;;

            xmlHttp.setRequestHeader(&apos;Content-Type&apos;, &apos;application/x-www-form-urlencoded;charset=utf-8&apos;);

            xmlHttp.send(postData);

        }

        else if (opt.method.toUpperCase() === &apos;GET&apos;) {

            xmlHttp.open(opt.method, opt.url + &apos;?&apos; + postData, opt.async);

            if(opt.dataType.toUpperCase() == &apos;XML&apos; || &apos;HTML&apos;)                             xmlHttp.responseType = &apos;document&apos;;

            xmlHttp.send(null);

        }

        xmlHttp.onreadystatechange = function () {

            if (xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200) {

                if (opt.dataType === &apos;JSON&apos;) {

                    //JSON.parse(xmlHttp.response)

                    opt.success(xmlHttp.response);

                }else{

                    opt.success(xmlHttp.response);

                }

            }

        };

    }

}

function creatScript(url, data) {

    var oScript = document.createElement(&apos;script&apos;);

    oScript.src = url + &apos;?&apos; + data + &apos;&amp;callback=getEn&apos;;

    document.body.appendChild(oScript);

}
</code></pre><p>1.dataType</p>
<p>2.函数自执行(是闭包的另外一种形式)</p>
<p>来解决for循环里i的变化</p>
<p>用特殊的手法把i给保存了,本来i会被清空,但是这个i我们用特殊的方法保留了下来</p>
<pre><code>for (var i = 0; i&lt;oLi.length ; i++)

{

    //函数自执行,传进去参数,并接受参数.两个参数i没关系,

    //外面的i是全局作用变量i,里面的i是函数作用域的i

    (function(i) {

        oLi[i].onclick = function() {

            getData(i+1);

            console.log(i);

            console.log(this.innerHTML);

        }

    })(i);

    //i本身会被清空

}
</code></pre><p>3.闭包的概念</p>
<p>通过一些特殊的手法让变量的值不会在一些情况中(比如说函数执行完毕之后被自动回收)</p>
<p>某一个即将被回收的值,阻止它返回或阻止它被回收</p>
<p>4.闭包的作用</p>
<p>保证作用域里的变量不会被污染不会被GC回收也不会被覆盖</p>
<p>5.由于事件的冒泡机制,有时候通过设置事件代理更简单</p>
<p>比如点击li,</p>
<p>实质也是在点击ul,</p>
<p>所以不需要给每个li单独设置点击事件</p>
<p>而是给ul设置监听事件</p>
<p>也就是事件绑定只用绑一个,</p>
<p>由于js的事件冒泡机制,其他的顺着子集一并绑定,</p>
<p>6.js的事件机制</p>
<p>捕获阶段</p>
<p>触发事件目标阶段</p>
<p>冒泡阶段</p>
<p>7.事件监听里面有个参数e</p>
<p>e是事件对象</p>
<p>里面会有很多关于本次事件的属性</p>
<p>8.事件对象的兼容处理</p>
<pre><code>function(e){

var e = e || window.event;

}
</code></pre><p>9.e.target就是当前点击触发的某个元素</p>
<p>10.e.target.tagName属性就是获取点击触发事件的元素的名字</p>
<p>注意此属性的值是大写</p>
<p>11.字符串转小写的方法:toLowerCase();</p>
<p>12.获取到点击元素的内容</p>
<p>e.target.innerText;</p>
<p>e.target.innerHTML;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">            //在外部var一个cache等于cacheData();</span><br><span class="line">    </span><br><span class="line">            //cacheData返回一个对象</span><br><span class="line">    </span><br><span class="line">            //在这个对象当中有一个get和set方法</span><br><span class="line">    </span><br><span class="line">            //然后就在getData执行时调用cache.set()</span><br><span class="line">    </span><br><span class="line">            var cache = cacheData();</span><br><span class="line">    </span><br><span class="line">            getData();//加载首屏数据</span><br><span class="line">    </span><br><span class="line">            //获取数据方法</span><br><span class="line">    </span><br><span class="line">            //此方法一旦执行一定是个新数据</span><br><span class="line">    </span><br><span class="line">            function getData(page) &#123;</span><br><span class="line">    </span><br><span class="line">                var page = page || 1;</span><br><span class="line">    </span><br><span class="line">                myAjax(&#123;</span><br><span class="line">    </span><br><span class="line">                    url:&quot;http://localhost/movie.phpdfsa&quot;,</span><br><span class="line">    </span><br><span class="line">                    data:&#123;page:page,limit:5&#125;,</span><br><span class="line">    </span><br><span class="line">                    success:function(doc) &#123;</span><br><span class="line">    </span><br><span class="line">                        var doc = JSON.parse(doc);//获取接口返回的数据</span><br><span class="line">    </span><br><span class="line">                        // console.log(doc);</span><br><span class="line">    </span><br><span class="line">                        //在此时缓存数据</span><br><span class="line">    </span><br><span class="line">                        //因为只要执行了getData方法一定是个新数据</span><br><span class="line">    </span><br><span class="line">                        //一定需要缓存</span><br><span class="line">    </span><br><span class="line">                        cache.set(page,doc);</span><br><span class="line">    </span><br><span class="line">                        //请求到的新数据直接渲染</span><br><span class="line">    </span><br><span class="line">                        renderData(doc);</span><br><span class="line">    </span><br><span class="line">                    &#125;</span><br><span class="line">    </span><br><span class="line">                &#125;);</span><br><span class="line">    </span><br><span class="line">            &#125;;</span><br><span class="line">    </span><br><span class="line">            //闭包的作用 作用域的变量不会被GC回收 覆盖</span><br><span class="line">    </span><br><span class="line">            var oUl = document.querySelector(&apos;.flex_row&apos;);</span><br><span class="line">    </span><br><span class="line">            </span><br><span class="line">    </span><br><span class="line">            //写一个类来做缓存池</span><br><span class="line">    </span><br><span class="line">            //缓存里面有两个方法,</span><br><span class="line">    </span><br><span class="line">            //一个用来设置,一个用来读取</span><br><span class="line">    </span><br><span class="line">            function cacheData() &#123;</span><br><span class="line">    </span><br><span class="line">                //因为使用来操作缓存的,所以需要var一个缓存</span><br><span class="line">    </span><br><span class="line">                //所有的缓存都放在这个缓存池变量里面</span><br><span class="line">    </span><br><span class="line">                //而为什么这个缓存变量是个对象呢</span><br><span class="line">    </span><br><span class="line">                //因为在这个对象里面key和value</span><br><span class="line">    </span><br><span class="line">                //key里可以直接放page</span><br><span class="line">    </span><br><span class="line">                //value直接放相对应的数据</span><br><span class="line">    </span><br><span class="line">                //所以说用一个对象的形式</span><br><span class="line">    </span><br><span class="line">                //这个对象是专门存数据的</span><br><span class="line">    </span><br><span class="line">                var cache = &#123;&#125;;//声明一个缓存池变量</span><br><span class="line">    </span><br><span class="line">                //那么操作数据的方法呢</span><br><span class="line">    </span><br><span class="line">                //因为是为了外界能够得到这个数据</span><br><span class="line">    </span><br><span class="line">                //所以要通过闭包让cache不会被回收</span><br><span class="line">    </span><br><span class="line">                //所以要return一个函数</span><br><span class="line">    </span><br><span class="line">                //但是因为要暴露两个方法</span><br><span class="line">    </span><br><span class="line">                //第一个方法是读取方法,第二个是设置方法</span><br><span class="line">    </span><br><span class="line">                //所以要return一个对象</span><br><span class="line">    </span><br><span class="line">                //这个对象当中有两个方法</span><br><span class="line">    </span><br><span class="line">                //第一个方法是set方法</span><br><span class="line">    </span><br><span class="line">                //第二个是get方法</span><br><span class="line">    </span><br><span class="line">                return &#123;</span><br><span class="line">    </span><br><span class="line">                    //set是用来存储新数据的</span><br><span class="line">    </span><br><span class="line">                    set:function(page,doc) &#123;</span><br><span class="line">    </span><br><span class="line">                        //那么在什么时候缓存数据</span><br><span class="line">    </span><br><span class="line">                        //应该在我们getData方法时缓存数据</span><br><span class="line">    </span><br><span class="line">                        //接收到page和doc就直接存进去</span><br><span class="line">    </span><br><span class="line">                        cache[page] = doc;//缓存</span><br><span class="line">    </span><br><span class="line">                    &#125;,//存储新数据</span><br><span class="line">    </span><br><span class="line">                    //get是用来读取数据的</span><br><span class="line">    </span><br><span class="line">                    //这样在缓存池中</span><br><span class="line">    </span><br><span class="line">                    //就会完成一个读一个写的动作</span><br><span class="line">    </span><br><span class="line">                    get:function(page) &#123;</span><br><span class="line">    </span><br><span class="line">                        //什么时候读数据</span><br><span class="line">    </span><br><span class="line">                        //点击的时候读数据</span><br><span class="line">    </span><br><span class="line">                        //所以点击的时候不是获取数据了而是读数据</span><br><span class="line">    </span><br><span class="line">                        //也就是读缓存</span><br><span class="line">    </span><br><span class="line">                        //度缓存就必须要传进来页数参数page</span><br><span class="line">    </span><br><span class="line">                        //要读第几页的数据</span><br><span class="line">    </span><br><span class="line">                        //那么毒缓存就需要判断缓存里是否存在这个数据</span><br><span class="line">    </span><br><span class="line">                        //所以要if判断,判断page是不是在cache属性内</span><br><span class="line">    </span><br><span class="line">                        //如果page在缓存池的变量当中就证明这是一个旧的数据</span><br><span class="line">    </span><br><span class="line">                        //不在就是一个新的数据</span><br><span class="line">    </span><br><span class="line">                        //in用来判断对象有没有这个key</span><br><span class="line">    </span><br><span class="line">                        if (page in cache) &#123;</span><br><span class="line">    </span><br><span class="line">                            //如果存在 就证明是一个已经缓存的数据</span><br><span class="line">    </span><br><span class="line">                            //如果已经缓存了</span><br><span class="line">    </span><br><span class="line">                            //那么直接渲染数据就可以</span><br><span class="line">    </span><br><span class="line">                            //就找到page页的cache数据</span><br><span class="line">    </span><br><span class="line">                            renderData(cache[page]);</span><br><span class="line">    </span><br><span class="line">                            console.log(&apos;页面第&apos;+page+&apos;数据已经缓存,无需再次请求&apos;);</span><br><span class="line">    </span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">    </span><br><span class="line">                            //如果不在</span><br><span class="line">    </span><br><span class="line">                            //就证明是一个新的数据,就直接通过getdata方法读取数据</span><br><span class="line">    </span><br><span class="line">                            getData(page);</span><br><span class="line">    </span><br><span class="line">                        &#125;</span><br><span class="line">    </span><br><span class="line">                    &#125; //读取数据</span><br><span class="line">    </span><br><span class="line">                &#125;</span><br><span class="line">    </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            </span><br><span class="line">    </span><br><span class="line">            //var一个content</span><br><span class="line">    </span><br><span class="line">            var oContent = document.querySelector(&apos;.content&apos;);</span><br><span class="line">    </span><br><span class="line">            oUl.addEventListener(&apos;click&apos;,function(e) &#123;</span><br><span class="line">    </span><br><span class="line">                var e = e || window.event;//兼容</span><br><span class="line">    </span><br><span class="line">                // console.log(e.target.tagName);</span><br><span class="line">    </span><br><span class="line">                if(e.target.tagName.toLowerCase() == &apos;li&apos;) &#123;</span><br><span class="line">    </span><br><span class="line">                    // console.log(0);</span><br><span class="line">    </span><br><span class="line">                    //什么时候读数据</span><br><span class="line">    </span><br><span class="line">                    //点击的时候读数据</span><br><span class="line">    </span><br><span class="line">                    //所以点击的时候不是获取数据了而是读数据</span><br><span class="line">    </span><br><span class="line">                    //也就是读缓存</span><br><span class="line">    </span><br><span class="line">                    //读第几页数据呢,要传进去页数</span><br><span class="line">    </span><br><span class="line">                    //要在get里读数据,需要知道缓存里是否存在这个数据</span><br><span class="line">    </span><br><span class="line">                    var page = e.target.innerText;</span><br><span class="line">    </span><br><span class="line">                    // getData(page);</span><br><span class="line">    </span><br><span class="line">                    cache.get(page);</span><br><span class="line">    </span><br><span class="line">                &#125;</span><br><span class="line">    </span><br><span class="line">            &#125;);//事件监听</span><br><span class="line">    </span><br><span class="line">            </span><br><span class="line">    </span><br><span class="line">            //渲染数据的方法</span><br><span class="line">    </span><br><span class="line">            //因为要渲染数据所以要得到数据</span><br><span class="line">    </span><br><span class="line">            function renderData(data) &#123;</span><br><span class="line">    </span><br><span class="line">                //得到数据后把数据放哪里呢</span><br><span class="line">    </span><br><span class="line">                //要把数据放到content里面</span><br><span class="line">    </span><br><span class="line">                var str = &apos;&apos;;//先放一个空字符串</span><br><span class="line">    </span><br><span class="line">                //通过data的数量来生成一个一个的a标签</span><br><span class="line">    </span><br><span class="line">                //因为得到的数据是是数组(通过JSON.parse方法已经得到数据)</span><br><span class="line">    </span><br><span class="line">                //所以需要遍历数组</span><br><span class="line">    </span><br><span class="line">                //通过foreach方法</span><br><span class="line">    </span><br><span class="line">                //注意!!!!!!forEach方法需要大写!!!!</span><br><span class="line">    </span><br><span class="line">                data.forEach(function(element)&#123;</span><br><span class="line">    </span><br><span class="line">                    //得到具体的数据</span><br><span class="line">    </span><br><span class="line">                    console.log(element);</span><br><span class="line">    </span><br><span class="line">                    //那么我们在什么时间段遍历数据</span><br><span class="line">    </span><br><span class="line">                    //在渲染数据的时候遍历数据</span><br><span class="line">    </span><br><span class="line">                    //什么时候渲染数据</span><br><span class="line">    </span><br><span class="line">                    //正鞥而流程就是通过点击事件读取数据(缓存)</span><br><span class="line">    </span><br><span class="line">                    //判断缓存里面是否存在</span><br><span class="line">    </span><br><span class="line">                    //如果存在就直接数据请求</span><br><span class="line">    </span><br><span class="line">                    //没有缓存就新请求getData,而在getData里面我们又会</span><br><span class="line">    </span><br><span class="line">                    //set设置缓存</span><br><span class="line">    </span><br><span class="line">                    //那么真正渲染数据的时候</span><br><span class="line">    </span><br><span class="line">                    //一个是缓存当中有数据的时候就直接渲染数据</span><br><span class="line">    </span><br><span class="line">                    //一个是每次请求新数据的时候都需要渲染一波</span><br><span class="line">    </span><br><span class="line">                    //这是字符串模板 ``</span><br><span class="line">    </span><br><span class="line">                    //这个玩意完全可以用+去拼接</span><br><span class="line">    </span><br><span class="line">                    //把a标签里所有的东西都拿过来去拼接</span><br><span class="line">    </span><br><span class="line">                    //然后就是修改里面的动态数据</span><br><span class="line">    </span><br><span class="line">                    //一:链接href数据是动态的,链接里数组里有</span><br><span class="line">    </span><br><span class="line">                    //用拼接模板拼接$</span><br><span class="line">    </span><br><span class="line">                    str += `</span><br><span class="line">    </span><br><span class="line">                        &lt;a href=&quot;$&#123;element.url&#125;&quot; class=&quot;items flex_row&quot;&gt;</span><br><span class="line"></span><br><span class="line">                        &lt;div class=&quot;img&quot;&gt;</span><br><span class="line">    </span><br><span class="line">                                &lt;img src=&quot;$&#123;element.cover&#125;&quot;&gt;</span><br><span class="line">    </span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">   </span><br><span class="line">                        &lt;div class=&quot;bd&quot;&gt;</span><br><span class="line">    </span><br><span class="line">                            &lt;p class=&quot;label&quot;&gt;$&#123;element.title&#125;&lt;/p&gt;</span><br><span class="line">    </span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;ft&quot;&gt;&amp;GT;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">                        &lt;/a&gt;</span><br><span class="line">    </span><br><span class="line">                    `;</span><br><span class="line">    </span><br><span class="line">                    //上面的字符串一旦收集完毕就把他赋值给oContent</span><br><span class="line">    </span><br><span class="line">                    oContent.innerHTML = str;</span><br><span class="line">    </span><br><span class="line">                &#125;);</span><br><span class="line">    </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            // var oLi = document.querySelectorAll(&apos;.flex_row li&apos;);</span><br><span class="line">    </span><br><span class="line">            // for (var i = 0; i&lt;oLi.length ; i++)</span><br><span class="line">    </span><br><span class="line">            // &#123;</span><br><span class="line">    </span><br><span class="line">            //  (function(i) &#123;</span><br><span class="line">    </span><br><span class="line">            //      oLi[i].onclick = function() &#123;</span><br><span class="line">    </span><br><span class="line">            //          getData(i+1);</span><br><span class="line">    </span><br><span class="line">            //          // console.log(i);</span><br><span class="line">    </span><br><span class="line">            //      &#125;</span><br><span class="line">    </span><br><span class="line">            //  &#125;)(i);</span><br><span class="line">    </span><br><span class="line">            // &#125;</span><br><span class="line">    </span><br><span class="line">        &lt;/script&gt;</span><br></pre></td></tr></table></figure>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <div id="comment" style="padding:10px;" class="vcomment"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'false' === 'true';
    var verify = 'false' === 'true';
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "p5ihLcNyFvzHr5DkkNYYJTup-gzGzoHsz",
        appKey: "u7Ijtw9Y891i7gP3JXdl3biI",
        placeholder: "见证友善的当下~",
        pageSize:'10',
        avatar:'identicon',
        lang:'zh-cn',
        guest_info: guest_info
    });
</script>


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/10/21/关于MySQL事物隔离/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.webp);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.webp" alt="MartianPotato's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        laddish@foxmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/10/">十月 2018<span class="sidebar_archives-count">2</span></a>
            </li></ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year=""></span>&nbsp;火星土豆的菜园
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/gh/viosey/hexo-theme-material@latest/source/js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>









   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 0000;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":0,"vOffset":-120},"mobile":{"show":false},"react":{"opacityDefault":1}});</script></body>
    
</html>
